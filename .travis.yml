language: node_js

node_js:
- "node"

cache:
  directories:
  - node_modules

env:
  global:
  - ENV=TEST
  - ADDRESS=0.0.0.0
  - PORT=10000
  - IDENTITY_SERVICE_HOST=null
  - GEMFURY_USER=neoncity
  # GEMFURY_API_KEY=???
  - secure: "XlmjrqUgKEAOVN8xnOx/VDjAT5XI6OoSA1doQdgxu0TpG7a1QHV1VeV7frwzltlEmyl9cuzVBK6e4gwBJfO9qWqtOHXznj7vdobV+TVBQzLIN+MyS5d1lIbN/P+7vRMXwzJ99Z5LAtBnzL1zaxS+U2BZxPMyM2t+EUYBVIzEZslQsB8pD8+z44hY2+TZRuDp6iDE7ZyoE/f0hCPa9adFdPz/SpXTAu9eNR+QilMScmjX35Xa4dVnI2GM+mWtVtUO1ysNQG8i1IIGW+AQcX5NAh03JU3LZZjmr8RA+sK1eQsXnONUYtAv1QiIpEnW37UFggiYXnJQd7wMKn5RQ4cFNY8opGVzVGLQp3GA/EN3Y4q+hqRJLHeaa7P66jSv+u7yw70vSe/JD2vh/CZyw/MyBG6+FXwLvoL3LjPQxj6OyRz1gkUImZHcLhShAN4zEHuioZOyq5h0oAZV59yZT6u76XfE/PcoSbWQ6C7oliu/t7MALsmvvhX5k4MbxvUziYoXgtlLSiwroUB6S8LKPaBDSsOr1mN99ZAijX2RsBYLCIDZxS9ndQFX6ngl5Ln8Uengv5sICawJ7d9B0Z4zIghlpm33r/5jJJwm6GFE/8Zz1gxLrf6/+6alkz2SBfhsAiCf7UhB3vPMOUOowqJ/fn6cCGehif6ANNomv13he5vTqz4="

install:
- npm install --registry=https://npm-proxy.fury.io/${GEMFURY_API_KEY}/${GEMFURY_USER}/ --progress=false

script:
- true # npm run test-with-coverage

# after_success:
# - npm run push-coverage-to-codecov

deploy:
- provider: script
  skip_cleanup: true
  script: $(npm bin)/togemfury --user ${GEMFURY_USER} --api_key ${GEMFURY_API_KEY}
